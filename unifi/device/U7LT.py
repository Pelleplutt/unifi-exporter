from . import device

class U7LT(device.Device):

    def __init__(self, site, data):
        super(U7LT, self).__init__(site, data)

        self.radio = {}
        self.vap = []
        self.parse_radio(data['radio_table'])
        self.parse_stat(data['stat'])
        self.parse_uplink(data['uplink'])
        self.parse_vap_table(data['vap_table'])
        self.parse_sysstat(data['sys_stats'])

    def parse_radio(self, data):
        for radio in data:
            rstr = radio['radio']
            self.radio[rstr] = radio

    def parse_vap_table(self, data):
        for vap in data:
            self.vap.append(vap)

#{ '_id': '5e0a384d3ad4ca2c3b71058c',
#  '_uptime': 183930,
#  'adoptable_when_upgraded': False,
#  'adopted': True,
#  'antenna_table': [{'default': True,
#                     'id': 4,
#                     'name': 'Combined',
#                     'wifi0_gain': 3,
#                     'wifi1_gain': 3}],
#  'architecture': 'mips',
#  'board_rev': 33,
#  'bytes': 71122830,
#  'bytes-d': 30585,
#  'bytes-r': 546,
#  'cfgversion': '5d2b2bdda4655237',
#  'config_network': {'dns1': '192.168.1.1',
#                     'dns2': '8.8.8.8',
#                     'gateway': '192.168.2.1',
#                     'ip': '192.168.2.5',
#                     'netmask': '255.255.255.0',
#                     'type': 'static'},
#  'connect_request_ip': '192.168.2.5',
#  'connect_request_port': '33643',
#  'considered_lost_at': 1577912362,
#  'countrycode_table': [],
#  'device_id': '5e0a384d3ad4ca2c3b71058c',
#  'dot1x_portctrl_enabled': False,
#  'downlink_table': [],
#  'ethernet_table': [{'mac': '74:83:c2:23:13:f1',
#                      'name': 'eth0',
#                      'num_port': 1}],
#  'fw_caps': 25099327,
#  'gateway_mac': '78:8a:20:37:6a:77',
#  'guest-num_sta': 0,
#  'guest-wlan-num_sta': 0,
#  'guest_token': 'B69035449300FB3B4EF0ABA5F3384293',
#  'has_eth1': False,
#  'has_fan': False,
#  'has_speaker': False,
#  'has_temperature': False,
#  'hash_id': 'eec2281a3882ebf3',
#  'hide_ch_width': 'none',
#  'hw_caps': 0,
#  'inform_ip': '192.168.1.3',
#  'inform_url': 'http://unifi:8080/inform',
#  'ip': '192.168.2.5',
#  'isolated': False,
#  'kernel_version': '4.4.153',
#  'known_cfgversion': '5d2b2bdda4655237',
#  'last_seen': 1577912188,
#  'last_uplink': {'uplink_mac': 'f0:9f:c2:68:77:f2',
#                  'uplink_remote_port': 2},
#  'lcm_brightness_override': False,
#  'lcm_idle_timeout_override': False,
#  'led_override': 'default',
#  'led_override_color': '#0000ff',
#  'led_override_color_brightness': 100,
#  'license_state': 'registered',
#  'locating': False,
#  'mac': '74:83:c2:23:13:f1',
#  'manufacturer_id': 4,
#  'meshv3_peer_mac': '',
#  'model': 'U7LT',
#  'name': 'unifi-garage',
#  'next_heartbeat_at': 1577912246,
#  'next_interval': 48,
#  'num_sta': 1,
#  'outdoor_mode_override': 'default',
#  'port_table': [],
#  'prev_non_busy_state': 1,
#  'radio_table': [{'antenna_gain': 6,
#                   'builtin_ant_gain': 3,
#                   'builtin_antenna': True,
#                   'channel': 'auto',
#                   'current_antenna_gain': 0,
#                   'ht': '20',
#                   'max_txpower': 20,
#                   'min_rssi_enabled': False,
#                   'min_txpower': 4,
#                   'name': 'wifi0',
#                   'nss': 2,
#                   'radio': 'ng',
#                   'radio_caps': 16404,
#                   'sens_level_enabled': False,
#                   'tx_power_mode': 'low',
#                   'vwire_enabled': False,
#                   'wlangroup_id': '5a58e041cac8962a35f4220c'},
#                  {'antenna_gain': 6,
#                   'builtin_ant_gain': 3,
#                   'builtin_antenna': True,
#                   'channel': 'auto',
#                   'current_antenna_gain': 0,
#                   'hard_noise_floor_enabled': False,
#                   'has_dfs': True,
#                   'has_fccdfs': True,
#                   'ht': '40',
#                   'is_11ac': True,
#                   'max_txpower': 20,
#                   'min_rssi_enabled': False,
#                   'min_txpower': 4,
#                   'name': 'wifi1',
#                   'nss': 2,
#                   'radio': 'na',
#                   'radio_caps': 50479124,
#                   'sens_level_enabled': False,
#                   'tx_power_mode': 'low',
#                   'vwire_enabled': False,
#                   'wlangroup_id': '5a58e041cac8962a35f4220c'}],
#  'radio_table_stats': [{'ast_be_xmit': 550,
#                         'ast_cst': None,
#                         'ast_txto': None,
#                         'channel': 6,
#                         'cu_self_rx': 0,
#                         'cu_self_tx': 2,
#                         'cu_total': 2,
#                         'extchannel': 0,
#                         'gain': 3,
#                         'guest-num_sta': 0,
#                         'name': 'wifi0',
#                         'num_sta': 1,
#                         'radio': 'ng',
#                         'satisfaction': 85,
#                         'state': 'RUN',
#                         'tx_packets': 16,
#                         'tx_power': 4,
#                         'tx_retries': 23,
#                         'user-num_sta': 1},
#                        {'ast_be_xmit': 550,
#                         'ast_cst': None,
#                         'ast_txto': None,
#                         'channel': 56,
#                         'cu_self_rx': 0,
#                         'cu_self_tx': 0,
#                         'cu_total': 0,
#                         'extchannel': -1,
#                         'gain': 3,
#                         'guest-num_sta': 0,
#                         'name': 'wifi1',
#                         'num_sta': 0,
#                         'radio': 'na',
#                         'satisfaction': -1,
#                         'state': 'RUN',
#                         'tx_packets': 0,
#                         'tx_power': 4,
#                         'tx_retries': 0,
#                         'user-num_sta': 0}],
#  'required_version': '3.4.1',
#  'rollupgrade': False,
#  'rx_bytes': 29404841,
#  'rx_bytes-d': 13114,
#  'satisfaction': 85,
#  'scan_radio_table': [],
#  'scanning': False,
#  'serial': '7483C22313F1',
#  'site_id': '56c87bc1b41038d25762ce86',
#  'spectrum_scanning': False,
#  'ssh_session_table': [],
#  'start_connected_millis': 1577728323849,
#  'start_disconnected_millis': 1577728306115,
#  'stat': {'ap': {'ap': '74:83:c2:23:13:f1',
#                  'bytes': 71122830.0,
#                  'datetime': '2019-12-30T17:50:00Z',
#                  'duration': 183824000.0,
#                  'guest-mac_filter_rejections': 0.0,
#                  'guest-rx_bytes': 0.0,
#                  'guest-rx_crypts': 0.0,
#                  'guest-rx_dropped': 0.0,
#                  'guest-rx_errors': 0.0,
#                  'guest-rx_frags': 0.0,
#                  'guest-rx_packets': 0.0,
#                  'guest-tx_bytes': 0.0,
#                  'guest-tx_dropped': 0.0,
#                  'guest-tx_errors': 0.0,
#                  'guest-tx_packets': 0.0,
#                  'guest-tx_retries': 0.0,
#                  'guest-wifi_tx_attempts': 0.0,
#                  'guest-wifi_tx_dropped': 0.0,
#                  'mac_filter_rejections': 0.0,
#                  'o': 'ap',
#                  'oid': '74:83:c2:23:13:f1',
#                  'rx_bytes': 29404841.0,
#                  'rx_crypts': 4.0,
#                  'rx_dropped': 15.0,
#                  'rx_errors': 15.0,
#                  'rx_frags': 0.0,
#                  'rx_packets': 140895.0,
#                  'site_id': '56c87bc1b41038d25762ce86',
#                  'time': 1577728200000,
#                  'tx_bytes': 41717989.0,
#                  'tx_dropped': 0.0,
#                  'tx_errors': 0.0,
#                  'tx_packets': 324932.0,
#                  'tx_retries': 28854.0,
#                  'user-mac_filter_rejections': 0.0,
#                  'user-rx_bytes': 29404841.0,
#                  'user-rx_crypts': 4.0,
#                  'user-rx_dropped': 15.0,
#                  'user-rx_errors': 15.0,
#                  'user-rx_frags': 0.0,
#                  'user-rx_packets': 140895.0,
#                  'user-tx_bytes': 41717989.0,
#                  'user-tx_dropped': 0.0,
#                  'user-tx_errors': 0.0,
#                  'user-tx_packets': 324932.0,
#                  'user-tx_retries': 28854.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-rx_bytes': 29404841.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-rx_crypts': 4.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-rx_dropped': 15.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-rx_errors': 15.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-rx_packets': 140895.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-tx_bytes': 41717989.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-tx_packets': 324932.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-tx_retries': 28854.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-wifi_tx_attempts': 50054.0,
#                  'user-wifi0-ath0-5a58e0a1cac8962a35f42218-wifi_tx_dropped': 30.0,
#                  'user-wifi0-mac_filter_rejections': 0.0,
#                  'user-wifi0-rx_bytes': 29404841.0,
#                  'user-wifi0-rx_crypts': 4.0,
#                  'user-wifi0-rx_dropped': 15.0,
#                  'user-wifi0-rx_errors': 15.0,
#                  'user-wifi0-rx_frags': 0.0,
#                  'user-wifi0-rx_packets': 140895.0,
#                  'user-wifi0-tx_bytes': 41717989.0,
#                  'user-wifi0-tx_dropped': 0.0,
#                  'user-wifi0-tx_errors': 0.0,
#                  'user-wifi0-tx_packets': 324932.0,
#                  'user-wifi0-tx_retries': 28854.0,
#                  'user-wifi0-wifi_tx_attempts': 50054.0,
#                  'user-wifi0-wifi_tx_dropped': 30.0,
#                  'user-wifi1-mac_filter_rejections': 0.0,
#                  'user-wifi1-rx_bytes': 0.0,
#                  'user-wifi1-rx_crypts': 0.0,
#                  'user-wifi1-rx_dropped': 0.0,
#                  'user-wifi1-rx_errors': 0.0,
#                  'user-wifi1-rx_frags': 0.0,
#                  'user-wifi1-rx_packets': 0.0,
#                  'user-wifi1-tx_bytes': 0.0,
#                  'user-wifi1-tx_dropped': 0.0,
#                  'user-wifi1-tx_errors': 0.0,
#                  'user-wifi1-tx_packets': 0.0,
#                  'user-wifi1-tx_retries': 0.0,
#                  'user-wifi1-wifi_tx_attempts': 0.0,
#                  'user-wifi1-wifi_tx_dropped': 0.0,
#                  'user-wifi_tx_attempts': 50054.0,
#                  'user-wifi_tx_dropped': 30.0,
#                  'wifi0-mac_filter_rejections': 0.0,
#                  'wifi0-rx_bytes': 29404841.0,
#                  'wifi0-rx_crypts': 4.0,
#                  'wifi0-rx_dropped': 15.0,
#                  'wifi0-rx_errors': 15.0,
#                  'wifi0-rx_frags': 0.0,
#                  'wifi0-rx_packets': 140895.0,
#                  'wifi0-tx_bytes': 41717989.0,
#                  'wifi0-tx_dropped': 0.0,
#                  'wifi0-tx_errors': 0.0,
#                  'wifi0-tx_packets': 324932.0,
#                  'wifi0-tx_retries': 28854.0,
#                  'wifi0-wifi_tx_attempts': 50054.0,
#                  'wifi0-wifi_tx_dropped': 30.0,
#                  'wifi1-mac_filter_rejections': 0.0,
#                  'wifi1-rx_bytes': 0.0,
#                  'wifi1-rx_crypts': 0.0,
#                  'wifi1-rx_dropped': 0.0,
#                  'wifi1-rx_errors': 0.0,
#                  'wifi1-rx_frags': 0.0,
#                  'wifi1-rx_packets': 0.0,
#                  'wifi1-tx_bytes': 0.0,
#                  'wifi1-tx_dropped': 0.0,
#                  'wifi1-tx_errors': 0.0,
#                  'wifi1-tx_packets': 0.0,
#                  'wifi1-tx_retries': 0.0,
#                  'wifi1-wifi_tx_attempts': 0.0,
#                  'wifi1-wifi_tx_dropped': 0.0,
#                  'wifi_tx_attempts': 50054.0,
#                  'wifi_tx_dropped': 30.0}},
#  'state': 1,
#  'sys_error_caps': 0,
#  'sys_stats': {'loadavg_1': '0.13',
#                'loadavg_15': '0.02',
#                'loadavg_5': '0.07',
#                'mem_buffer': 0,
#                'mem_total': 128622592,
#                'mem_used': 66560000},
#  'syslog_key': 'ccd550043b8d6d80114350aac32cf972418a3c017acb68bf0f08046e4f0d2ff8',
#  'system-stats': {'cpu': '2.5', 'mem': '29.7', 'uptime': '183930'},
#  'two_phase_adopt': False,
#  'tx_bytes': 41717989,
#  'tx_bytes-d': 17471,
#  'type': 'uap',
#  'unsupported': False,
#  'unsupported_reason': 0,
#  'upgradable': False,
#  'uplink': {'full_duplex': True,
#             'ip': '0.0.0.0',
#             'mac': '74:83:c2:23:13:f1',
#             'max_speed': 1000,
#             'name': 'eth0',
#             'netmask': '0.0.0.0',
#             'num_port': 1,
#             'rx_bytes': 33550712,
#             'rx_bytes-r': 198,
#             'rx_dropped': 6083,
#             'rx_errors': 0,
#             'rx_multicast': 0,
#             'rx_packets': 451161,
#             'speed': 1000,
#             'tx_bytes': 53062431,
#             'tx_bytes-r': 354,
#             'tx_dropped': 0,
#             'tx_errors': 0,
#             'tx_packets': 263086,
#             'type': 'wire',
#             'up': True,
#             'uplink_mac': 'f0:9f:c2:68:77:f2',
#             'uplink_remote_port': 2},
#  'uplink_table': [],
#  'uptime': 183930,
#  'user-num_sta': 1,
#  'user-wlan-num_sta': 1,
#  'vap_table': [{'anomalies_bar_chart': {'high_dns_latency': 0,
#                                         'high_tcp_latency': 0,
#                                         'high_tcp_packet_loss': 0,
#                                         'high_wifi_latency': 0,
#                                         'high_wifi_retries': 0,
#                                         'low_phy_rate': 0,
#                                         'poor_stream_eff': 0,
#                                         'sleepy_client': 0,
#                                         'sta_arp_timeout': 0,
#                                         'sta_dns_timeout': 0,
#                                         'sta_ip_timeout': 0,
#                                         'weak_signal': 0},
#                 'anomalies_bar_chart_now': {'high_dns_latency': 0,
#                                             'high_tcp_latency': 0,
#                                             'high_tcp_packet_loss': 0,
#                                             'high_wifi_latency': 0,
#                                             'high_wifi_retries': 0,
#                                             'low_phy_rate': 0,
#                                             'poor_stream_eff': 0,
#                                             'sleepy_client': 0,
#                                             'sta_arp_timeout': 0,
#                                             'sta_dns_timeout': 0,
#                                             'sta_ip_timeout': 0,
#                                             'weak_signal': 0},
#                 'ap_mac': '74:83:c2:23:13:f1',
#                 'avg_client_signal': 0,
#                 'bssid': '74:83:c2:25:13:f1',
#                 'ccq': 0,
#                 'channel': 56,
#                 'dns_avg_latency': -1,
#                 'essid': 'GNet',
#                 'extchannel': -1,
#                 'id': '5a58e0a1cac8962a35f42218',
#                 'is_guest': False,
#                 'is_wep': False,
#                 'mac_filter_rejections': 0,
#                 'map_id': None,
#                 'name': 'ath1',
#                 'num_satisfaction_sta': 0,
#                 'num_sta': 0,
#                 'radio': 'na',
#                 'radio_name': 'wifi1',
#                 'reasons_bar_chart': {'phy_rate': 0,
#                                       'signal': 0,
#                                       'sleepy_client': 0,
#                                       'sta_arp_timeout': 0,
#                                       'sta_dns_latency': 0,
#                                       'sta_dns_timeout': 0,
#                                       'sta_ip_timeout': 0,
#                                       'stream_eff': 0,
#                                       'tcp_latency': 0,
#                                       'tcp_packet_loss': 0,
#                                       'wifi_latency': 0,
#                                       'wifi_retries': 0},
#                 'reasons_bar_chart_now': {'phy_rate': 0,
#                                           'signal': 0,
#                                           'sleepy_client': 0,
#                                           'sta_arp_timeout': 0,
#                                           'sta_dns_latency': 0,
#                                           'sta_dns_timeout': 0,
#                                           'sta_ip_timeout': 0,
#                                           'stream_eff': 0,
#                                           'tcp_latency': 0,
#                                           'tcp_packet_loss': 0,
#                                           'wifi_latency': 0,
#                                           'wifi_retries': 0},
#                 'rx_bytes': 0,
#                 'rx_crypts': 0,
#                 'rx_dropped': 0,
#                 'rx_errors': 0,
#                 'rx_frags': 0,
#                 'rx_nwids': 1034,
#                 'rx_packets': 0,
#                 'rx_tcp_stats': {'goodbytes': 0,
#                                  'lat_avg': 0,
#                                  'lat_max': 0,
#                                  'lat_min': 4294967295,
#                                  'stalls': 0},
#                 'satisfaction': -1,
#                 'satisfaction_now': -1,
#                 'site_id': '56c87bc1b41038d25762ce86',
#                 'state': 'RUN',
#                 't': 'vap',
#                 'tx_bytes': 0,
#                 'tx_combined_retries': 0,
#                 'tx_data_mpdu_bytes': 0,
#                 'tx_dropped': 0,
#                 'tx_errors': 0,
#                 'tx_packets': 0,
#                 'tx_power': 4,
#                 'tx_retries': 0,
#                 'tx_rts_retries': 0,
#                 'tx_success': 0,
#                 'tx_tcp_stats': {'goodbytes': 0,
#                                  'lat_avg': 0,
#                                  'lat_max': 0,
#                                  'lat_min': 4294967295,
#                                  'stalls': 0},
#                 'tx_total': 0,
#                 'up': True,
#                 'usage': 'user',
#                 'wifi_tx_attempts': 0,
#                 'wifi_tx_dropped': 0,
#                 'wlanconf_id': '5a58e0a1cac8962a35f42218'},
#                {'anomalies_bar_chart': {'high_dns_latency': 0,
#                                         'high_tcp_latency': 0,
#                                         'high_tcp_packet_loss': 0,
#                                         'high_wifi_latency': 0,
#                                         'high_wifi_retries': 0,
#                                         'low_phy_rate': 0,
#                                         'poor_stream_eff': 0,
#                                         'sleepy_client': 0,
#                                         'sta_arp_timeout': 0,
#                                         'sta_dns_timeout': 0,
#                                         'sta_ip_timeout': 0,
#                                         'weak_signal': 0},
#                 'anomalies_bar_chart_now': {'high_dns_latency': 0,
#                                             'high_tcp_latency': 0,
#                                             'high_tcp_packet_loss': 0,
#                                             'high_wifi_latency': 0,
#                                             'high_wifi_retries': 0,
#                                             'low_phy_rate': 0,
#                                             'poor_stream_eff': 0,
#                                             'sleepy_client': 0,
#                                             'sta_arp_timeout': 0,
#                                             'sta_dns_timeout': 0,
#                                             'sta_ip_timeout': 0,
#                                             'weak_signal': 0},
#                 'ap_mac': '74:83:c2:23:13:f1',
#                 'avg_client_signal': -79,
#                 'bssid': '74:83:c2:24:13:f1',
#                 'ccq': 883,
#                 'channel': 6,
#                 'dns_avg_latency': -1,
#                 'essid': 'GNet',
#                 'id': '5a58e0a1cac8962a35f42218',
#                 'is_guest': False,
#                 'is_wep': False,
#                 'mac_filter_rejections': 0,
#                 'map_id': None,
#                 'name': 'ath0',
#                 'num_satisfaction_sta': 1,
#                 'num_sta': 1,
#                 'radio': 'ng',
#                 'radio_name': 'wifi0',
#                 'reasons_bar_chart': {'phy_rate': 0,
#                                       'signal': 0,
#                                       'sleepy_client': 0,
#                                       'sta_arp_timeout': 0,
#                                       'sta_dns_latency': 0,
#                                       'sta_dns_timeout': 0,
#                                       'sta_ip_timeout': 0,
#                                       'stream_eff': 0,
#                                       'tcp_latency': 0,
#                                       'tcp_packet_loss': 0,
#                                       'wifi_latency': 0,
#                                       'wifi_retries': 1},
#                 'reasons_bar_chart_now': {'phy_rate': 0,
#                                           'signal': 0,
#                                           'sleepy_client': 0,
#                                           'sta_arp_timeout': 0,
#                                           'sta_dns_latency': 0,
#                                           'sta_dns_timeout': 0,
#                                           'sta_ip_timeout': 0,
#                                           'stream_eff': 0,
#                                           'tcp_latency': 0,
#                                           'tcp_packet_loss': 0,
#                                           'wifi_latency': 0,
#                                           'wifi_retries': 1},
#                 'rx_bytes': 29275129,
#                 'rx_crypts': 3,
#                 'rx_dropped': 13,
#                 'rx_errors': 13,
#                 'rx_frags': 0,
#                 'rx_nwids': 336012,
#                 'rx_packets': 140334,
#                 'rx_tcp_stats': {'goodbytes': 234,
#                                  'lat_avg': 0,
#                                  'lat_max': 0,
#                                  'lat_min': 4294967295,
#                                  'stalls': 0},
#                 'satisfaction': 85,
#                 'satisfaction_now': 80,
#                 'site_id': '56c87bc1b41038d25762ce86',
#                 'state': 'RUN',
#                 't': 'vap',
#                 'tx_bytes': 41556807,
#                 'tx_combined_retries': 53,
#                 'tx_data_mpdu_bytes': 3969,
#                 'tx_dropped': 0,
#                 'tx_errors': 0,
#                 'tx_packets': 323775,
#                 'tx_power': 4,
#                 'tx_retries': 48,
#                 'tx_rts_retries': 5,
#                 'tx_success': 25,
#                 'tx_tcp_stats': {'goodbytes': 446,
#                                  'lat_avg': 0,
#                                  'lat_max': 0,
#                                  'lat_min': 4294967295,
#                                  'stalls': 0},
#                 'tx_total': 25,
#                 'up': True,
#                 'usage': 'user',
#                 'wifi_tx_attempts': 73,
#                 'wifi_tx_dropped': 0,
#                 'wifi_tx_latency_mov': {'avg': 373,
#                                         'max': 3390,
#                                         'min': 0,
#                                         'total': 8594,
#                                         'total_count': 23},
#                 'wlanconf_id': '5a58e0a1cac8962a35f42218'}],
#  'version': '4.0.69.10871',
#  'vwireEnabled': True,
#  'vwire_table': [],
#  'vwire_vap_table': [],
#  'watching': False,
#  'watching_timeout': 1577729521,
#  'wifi_caps': 573429,
#  'wlan_overrides': [],
#  'x_aes_gcm': True,
#  'x_authkey': '332034f43157c9e2c92364d46fcdcf99',
#  'x_fingerprint': '4b:60:b1:e3:41:03:60:68:85:71:ed:2c:ba:19:5e:97',
#  'x_has_ssh_hostkey': False,
#  'x_inform_authkey': '332034f43157c9e2c92364d46fcdcf99',
#  'x_vwirekey': 'ec65e5d30728f3300c52df07d7e0cae9'},
#
