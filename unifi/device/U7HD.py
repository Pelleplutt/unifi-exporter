from . import device

class U7HD(device.Device):

    def __init__(self, site, data):
        super(U7HD, self).__init__(site, data)

        self.radio = {}
        self.vap = []
        self.parse_radio(data['radio_table'])
        self.parse_stat(data['stat'])
        self.parse_uplink(data.get('uplink'))
        self.parse_vap_table(data['vap_table'])
        self.parse_sysstat(data['sys_stats'])

    def parse_radio(self, data):
        for radio in data:
            rstr = radio['radio']
            self.radio[rstr] = radio

    def parse_vap_table(self, data):
        for vap in data:
            self.vap.append(vap)

# {u'_id': u'5a58df08cac8962a35f421f7',
# u'_uptime': 150116,
# u'adopt_ip': u'192.168.1.197',
# u'adopt_url': u'http://192.168.1.3:8080/inform',
# u'adopted': True,
# u'antenna_table': [{u'id': 4,
#                     u'name': u'Combined',
#                     u'wifi0_gain': 4,
#                     u'wifi1_gain': 3}],
# u'bandsteering_mode': u'prefer_5g',
# u'board_rev': 27,
# u'bytes': 14639435018,
# u'bytes-d': 636623,
# u'bytes-r': 19291,
# u'cfgversion': u'3a396b51789eeae9',
# u'config_network': {u'ip': u'192.168.1.197', u'type': u'dhcp'},
# u'connect_request_ip': u'192.168.1.197',
# u'connect_request_port': u'35734',
# u'considered_lost_at': 1515926542,
# u'countrycode_table': [],
# u'default': False,
# u'device_id': u'5a58df08cac8962a35f421f7',
# u'discovered_via': u'l2',
# u'downlink_table': [],
# u'ethernet_table': [{u'mac': u'f0:9f:c2:6c:15:5c',
#                      u'name': u'eth0',
#                      u'num_port': 1},
#                     {u'mac': u'f0:9f:c2:6c:15:5d',
#                      u'name': u'eth1',
#                      u'num_port': 1}],
# u'fw_caps': 196271,
# u'guest-num_sta': 0,
# u'guest_token': u'...',
# u'has_eth1': True,
# u'has_speaker': False,
# u'inform_ip': u'192.168.1.3',
# u'inform_url': u'http://192.168.1.3:8080/inform',
# u'ip': u'192.168.1.197',
# u'isolated': False,
# u'known_cfgversion': u'3a396b51789eeae9',
# u'last_seen': 1515926416,
# u'last_uplink': {u'uplink_mac': u'f0:9f:c2:0a:4a:ca',
#                  u'uplink_remote_port': 5},
# u'led_override': u'default',
# u'license_state': u'registered',
# u'locating': False,
# u'mac': u'f0:9f:c2:6c:15:5c',
# u'model': u'U7HD',
# u'na-channel': 48,
# u'na-eirp': 23,
# u'na-extchannel': -1,
# u'na-gain': 4,
# u'na-guest-num_sta': 0,
# u'na-num_sta': 6,
# u'na-state': u'RUN',
# u'na-tx_power': 19,
# u'na-user-num_sta': 6,
# u'na_ast_be_xmit': 591,
# u'na_ast_cst': None,
# u'na_ast_txto': None,
# u'na_cu_self_rx': 0,
# u'na_cu_self_tx': 1,
# u'na_cu_total': 2,
# u'na_tx_packets': 815,
# u'na_tx_retries': 0,
# u'name': u'unifi-bv',
# u'next_heartbeat_at': 1515926458,
# u'ng-channel': 6,
# u'ng-eirp': 20,
# u'ng-extchannel': 0,
# u'ng-gain': 3,
# u'ng-guest-num_sta': 0,
# u'ng-num_sta': 2,
# u'ng-state': u'RUN',
# u'ng-tx_power': 17,
# u'ng-user-num_sta': 2,
# u'ng_ast_be_xmit': 621,
# u'ng_ast_cst': None,
# u'ng_ast_txto': None,
# u'ng_cu_self_rx': 0,
# u'ng_cu_self_tx': 5,
# u'ng_cu_total': 5,
# u'ng_tx_packets': 4,
# u'ng_tx_retries': 0,
# u'num_sta': 8,
# u'outdoor_mode_override': u'default',
# u'port_stats': [],
# u'port_table': [],
# u'radio_table': [{u'builtin_ant_gain': 4,
#                   u'builtin_antenna': True,
#                   u'current_antenna_gain': 0,
#                   u'has_dfs': True,
#                   u'has_fccdfs': True,
#                   u'has_ht160': True,
#                   u'is_11ac': True,
#                   u'max_txpower': 25,
#                   u'min_txpower': 6,
#                   u'name': u'wifi0',
#                   u'nss': 4,
#                   u'radio': u'na',
#                   u'radio_caps': 251805700},
#                  {u'builtin_ant_gain': 3,
#                   u'builtin_antenna': True,
#                   u'current_antenna_gain': 0,
#                   u'max_txpower': 25,
#                   u'min_txpower': 6,
#                   u'name': u'wifi1',
#                   u'nss': 4,
#                   u'radio': u'ng',
#                   u'radio_caps': 67125252}],
# u'rollupgrade': False,
# u'rx_bytes': 1380985170,
# u'rx_bytes-d': 419787,
# u'scan_radio_table': [],
# u'scanning': False,
# u'serial': u'F09FC26C155C',
# u'site_id': u'56c87bc1b41038d25762ce86',
# u'spectrum_scanning': False,
# u'ssh_session_table': [],
# u'stat': {u'ap': u'f0:9f:c2:6c:15:5c',
#           u'bytes': 14639435018.0,
#           u'datetime': u'2018-01-13T07:45:00Z',
#           u'duration': 96730000.0,
#           u'guest-rx_bytes': 0.0,
#           u'guest-rx_crypts': 0.0,
#           u'guest-rx_dropped': 0.0,
#           u'guest-rx_errors': 0.0,
#           u'guest-rx_frags': 0.0,
#           u'guest-rx_packets': 0.0,
#           u'guest-tx_bytes': 0.0,
#           u'guest-tx_dropped': 0.0,
#           u'guest-tx_errors': 0.0,
#           u'guest-tx_packets': 0.0,
#           u'guest-tx_retries': 0.0,
#           u'na-rx_bytes': 1240595221.0,
#           u'na-rx_crypts': 1.0,
#           u'na-rx_dropped': 1.0,
#           u'na-rx_errors': 1.0,
#           u'na-rx_frags': 0.0,
#           u'na-rx_packets': 4013495.0,
#           u'na-tx_bytes': 12966810700.0,
#           u'na-tx_dropped': 169126.0,
#           u'na-tx_errors': 1184.0,
#           u'na-tx_packets': 10027141.0,
#           u'na-tx_retries': 252682.0,
#           u'ng-rx_bytes': 140389949.0,
#           u'ng-rx_crypts': 0.0,
#           u'ng-rx_dropped': 0.0,
#           u'ng-rx_errors': 0.0,
#           u'ng-rx_frags': 0.0,
#           u'ng-rx_packets': 429169.0,
#           u'ng-tx_bytes': 291639148.0,
#           u'ng-tx_dropped': 256294.0,
#           u'ng-tx_errors': 18.0,
#           u'ng-tx_packets': 390644.0,
#           u'ng-tx_retries': 14819.0,
#           u'o': u'ap',
#           u'oid': u'f0:9f:c2:6c:15:5c',
#           u'rx_bytes': 1380985170.0,
#           u'rx_crypts': 1.0,
#           u'rx_dropped': 1.0,
#           u'rx_errors': 1.0,
#           u'rx_frags': 0.0,
#           u'rx_packets': 4442664.0,
#           u'site_id': u'56c87bc1b41038d25762ce86',
#           u'time': 1515829500000,
#           u'tx_bytes': 13258449848.0,
#           u'tx_dropped': 425420.0,
#           u'tx_errors': 1202.0,
#           u'tx_packets': 10417785.0,
#           u'tx_retries': 267501.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-rx_bytes': 1183713183.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-rx_crypts': 1.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-rx_dropped': 1.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-rx_errors': 1.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-rx_packets': 3859396.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-tx_bytes': 12754522054.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-tx_dropped': 38.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-tx_errors': 1154.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-tx_packets': 9776810.0,
#           u'user-na-ath1-56c87f21b41038d25762ce95-tx_retries': 246005.0,
#           u'user-na-ath2-56c96f62b41038d25762ceac-rx_bytes': 56882038.0,
#           u'user-na-ath2-56c96f62b41038d25762ceac-rx_packets': 154099.0,
#           u'user-na-ath2-56c96f62b41038d25762ceac-tx_bytes': 212288646.0,
#           u'user-na-ath2-56c96f62b41038d25762ceac-tx_dropped': 169088.0,
#           u'user-na-ath2-56c96f62b41038d25762ceac-tx_errors': 30.0,
#           u'user-na-ath2-56c96f62b41038d25762ceac-tx_packets': 250331.0,
#           u'user-na-ath2-56c96f62b41038d25762ceac-tx_retries': 6677.0,
#           u'user-na-rx_bytes': 1240595221.0,
#           u'user-na-rx_crypts': 1.0,
#           u'user-na-rx_dropped': 1.0,
#           u'user-na-rx_errors': 1.0,
#           u'user-na-rx_frags': 0.0,
#           u'user-na-rx_packets': 4013495.0,
#           u'user-na-tx_bytes': 12966810700.0,
#           u'user-na-tx_dropped': 169126.0,
#           u'user-na-tx_errors': 1184.0,
#           u'user-na-tx_packets': 10027141.0,
#           u'user-na-tx_retries': 252682.0,
#           u'user-ng-ath3-56c87f21b41038d25762ce95-rx_bytes': 2462134.0,
#           u'user-ng-ath3-56c87f21b41038d25762ce95-rx_packets': 5682.0,
#           u'user-ng-ath3-56c87f21b41038d25762ce95-tx_bytes': 2684629.0,
#           u'user-ng-ath3-56c87f21b41038d25762ce95-tx_dropped': 256288.0,
#           u'user-ng-ath3-56c87f21b41038d25762ce95-tx_errors': 4.0,
#           u'user-ng-ath3-56c87f21b41038d25762ce95-tx_packets': 8372.0,
#           u'user-ng-ath3-56c87f21b41038d25762ce95-tx_retries': 1982.0,
#           u'user-ng-ath4-56c96f62b41038d25762ceac-rx_bytes': 137927815.0,
#           u'user-ng-ath4-56c96f62b41038d25762ceac-rx_packets': 423487.0,
#           u'user-ng-ath4-56c96f62b41038d25762ceac-tx_bytes': 288954519.0,
#           u'user-ng-ath4-56c96f62b41038d25762ceac-tx_dropped': 6.0,
#           u'user-ng-ath4-56c96f62b41038d25762ceac-tx_errors': 14.0,
#           u'user-ng-ath4-56c96f62b41038d25762ceac-tx_packets': 382272.0,
#           u'user-ng-ath4-56c96f62b41038d25762ceac-tx_retries': 12837.0,
#           u'user-ng-rx_bytes': 140389949.0,
#           u'user-ng-rx_crypts': 0.0,
#           u'user-ng-rx_dropped': 0.0,
#           u'user-ng-rx_errors': 0.0,
#           u'user-ng-rx_frags': 0.0,
#           u'user-ng-rx_packets': 429169.0,
#           u'user-ng-tx_bytes': 291639148.0,
#           u'user-ng-tx_dropped': 256294.0,
#           u'user-ng-tx_errors': 18.0,
#           u'user-ng-tx_packets': 390644.0,
#           u'user-ng-tx_retries': 14819.0,
#           u'user-rx_bytes': 1380985170.0,
#           u'user-rx_crypts': 1.0,
#           u'user-rx_dropped': 1.0,
#           u'user-rx_errors': 1.0,
#           u'user-rx_frags': 0.0,
#           u'user-rx_packets': 4442664.0,
#           u'user-tx_bytes': 13258449848.0,
#           u'user-tx_dropped': 425420.0,
#           u'user-tx_errors': 1202.0,
#           u'user-tx_packets': 10417785.0,
#           u'user-tx_retries': 267501.0},
# u'state': 1,
# u'sys_stats': {u'loadavg_1': u'1.00',
#                u'loadavg_15': u'1.05',
#                u'loadavg_5': u'1.02',
#                u'mem_buffer': 0,
#                u'mem_total': 486551552,
#                u'mem_used': 162893824},
# u'system-stats': {u'cpu': u'5.9',
#                   u'mem': u'33.5',
#                   u'uptime': u'150116'},
# u'tx_bytes': 13258449848,
# u'tx_bytes-d': 216836,
# u'type': u'uap',
# u'upgradable': False,
# u'uplink': {u'full_duplex': True,
#             u'ip': u'0.0.0.0',
#             u'lag_member': False,
#             u'mac': u'f0:9f:c2:6c:15:5c',
#             u'max_speed': 1000,
#             u'name': u'eth0',
#             u'netmask': u'0.0.0.0',
#             u'num_port': 1,
#             u'rx_bytes': 17902649638,
#             u'rx_bytes-r': 5151,
#             u'rx_dropped': 4949,
#             u'rx_errors': 0,
#             u'rx_multicast': 0,
#             u'rx_packets': 14392430,
#             u'speed': 1000,
#             u'tx_bytes': 1769687054,
#             u'tx_bytes-r': 12660,
#             u'tx_dropped': 0,
#             u'tx_errors': 0,
#             u'tx_packets': 5490393,
#             u'type': u'wire',
#             u'up': True,
#             u'uplink_mac': u'f0:9f:c2:0a:4a:ca',
#             u'uplink_remote_port': 5},
# u'uplink_table': [],
# u'uptime': 150116,
# u'user-num_sta': 8,
# u'vap_table': [{u'ap_mac': u'f0:9f:c2:6c:15:5c',
#                 u'bssid': u'f2:9f:c2:6c:15:5e',
#                 u'ccq': 333,
#                 u'channel': 48,
#                 u'essid': u'PNet',
#                 u'extchannel': -1,
#                 u'id': u'56c87f21b41038d25762ce95',
#                 u'is_guest': False,
#                 u'is_wep': False,
#                 u'map_id': None,
#                 u'name': u'ath1',
#                 u'num_sta': 5,
#                 u'radio': u'na',
#                 u'radio_name': u'wifi0',
#                 u'rx_bytes': 1572801915,
#                 u'rx_crypts': 2,
#                 u'rx_dropped': 2,
#                 u'rx_errors': 2,
#                 u'rx_frags': 0,
#                 u'rx_nwids': 1913,
#                 u'rx_packets': 4858899,
#                 u'site_id': u'56c87bc1b41038d25762ce86',
#                 u'state': u'RUN',
#                 u't': u'vap',
#                 u'tx_bytes': 15441843909,
#                 u'tx_dropped': 388,
#                 u'tx_errors': 1625,
#                 u'tx_packets': 12135551,
#                 u'tx_power': 19,
#                 u'tx_retries': 178558,
#                 u'up': True,
#                 u'usage': u'user',
#                 u'wlanconf_id': u'56c87f21b41038d25762ce95'},
#                {u'ap_mac': u'f0:9f:c2:6c:15:5c',
#                 u'bssid': u'02:9f:c2:6c:15:5e',
#                 u'ccq': 333,
#                 u'channel': 48,
#                 u'essid': u'MyNet',
#                 u'extchannel': -1,
#                 u'id': u'56c96f62b41038d25762ceac',
#                 u'is_guest': False,
#                 u'is_wep': False,
#                 u'map_id': None,
#                 u'name': u'ath2',
#                 u'num_sta': 1,
#                 u'radio': u'na',
#                 u'radio_name': u'wifi0',
#                 u'rx_bytes': 83106158,
#                 u'rx_crypts': 0,
#                 u'rx_dropped': 0,
#                 u'rx_errors': 0,
#                 u'rx_frags': 0,
#                 u'rx_nwids': 2470,
#                 u'rx_packets': 200288,
#                 u'site_id': u'56c87bc1b41038d25762ce86',
#                 u'state': u'RUN',
#                 u't': u'vap',
#                 u'tx_bytes': 279875572,
#                 u'tx_dropped': 372570,
#                 u'tx_errors': 45,
#                 u'tx_packets': 324952,
#                 u'tx_power': 19,
#                 u'tx_retries': 831,
#                 u'up': True,
#                 u'usage': u'user',
#                 u'wlanconf_id': u'56c96f62b41038d25762ceac'},
#                {u'ap_mac': u'f0:9f:c2:6c:15:5c',
#                 u'bssid': u'f0:9f:c2:6c:15:5f',
#                 u'ccq': 333,
#                 u'channel': 6,
#                 u'essid': u'PNet',
#                 u'id': u'56c87f21b41038d25762ce95',
#                 u'is_guest': False,
#                 u'is_wep': False,
#                 u'map_id': None,
#                 u'name': u'ath3',
#                 u'num_sta': 0,
#                 u'radio': u'ng',
#                 u'radio_name': u'wifi1',
#                 u'rx_bytes': 2731731,
#                 u'rx_crypts': 0,
#                 u'rx_dropped': 0,
#                 u'rx_errors': 0,
#                 u'rx_frags': 0,
#                 u'rx_nwids': 6316,
#                 u'rx_packets': 6498,
#                 u'site_id': u'56c87bc1b41038d25762ce86',
#                 u'state': u'RUN',
#                 u't': u'vap',
#                 u'tx_bytes': 3676861,
#                 u'tx_dropped': 476641,
#                 u'tx_errors': 4,
#                 u'tx_packets': 15116,
#                 u'tx_power': 17,
#                 u'tx_retries': 0,
#                 u'up': True,
#                 u'usage': u'user',
#                 u'wlanconf_id': u'56c87f21b41038d25762ce95'},
#                {u'ap_mac': u'f0:9f:c2:6c:15:5c',
#                 u'bssid': u'f2:9f:c2:6c:15:5f',
#                 u'ccq': 24,
#                 u'channel': 6,
#                 u'essid': u'MyNet',
#                 u'id': u'56c96f62b41038d25762ceac',
#                 u'is_guest': False,
#                 u'is_wep': False,
#                 u'map_id': None,
#                 u'name': u'ath4',
#                 u'num_sta': 2,
#                 u'radio': u'ng',
#                 u'radio_name': u'wifi1',
#                 u'rx_bytes': 139285571,
#                 u'rx_crypts': 0,
#                 u'rx_dropped': 0,
#                 u'rx_errors': 0,
#                 u'rx_frags': 0,
#                 u'rx_nwids': 6686,
#                 u'rx_packets': 434271,
#                 u'site_id': u'56c87bc1b41038d25762ce86',
#                 u'state': u'RUN',
#                 u't': u'vap',
#                 u'tx_bytes': 305658475,
#                 u'tx_dropped': 224798,
#                 u'tx_errors': 23,
#                 u'tx_packets': 397088,
#                 u'tx_power': 17,
#                 u'tx_retries': 12618,
#                 u'up': True,
#                 u'usage': u'user',
#                 u'wlanconf_id': u'56c96f62b41038d25762ceac'}],
# u'version': u'3.9.19.8123',
# u'vwireEnabled': True,
# u'vwire_table': [],
# u'wifi_caps': 16229,
# u'wlangroup_id_na': u'56c87bd0b41038d25762ce8d',
# u'wlangroup_id_ng': u'56c87bd0b41038d25762ce8d',
# u'x_authkey': u'da527e89518a57f4c614ecbb0e8cf144',
# u'x_fingerprint': u'2f:be:59:32:99:ba:fd:64:33:4e:a8:52:8f:60:ab:1d',
# u'x_has_ssh_hostkey': True,
# u'x_inform_authkey': u'da527e89518a57f4c614ecbb0e8cf144',
# u'x_ssh_hostkey_fingerprint': u'2f:be:59:32:99:ba:fd:64:33:4e:a8:52:8f:60:ab:1d',
# u'x_vwirekey': u'8d961eb45c1bbb879c0118ed1325a994'},
